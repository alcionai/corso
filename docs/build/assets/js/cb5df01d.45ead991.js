"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[81],{3901:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(7294),a=n(3743);const r="tableOfContentsInline_prmo";function s(e){let{toc:t,minHeadingLevel:n,maxHeadingLevel:s}=e;return o.createElement("div",{className:r},o.createElement(a.Z,{toc:t,minHeadingLevel:n,maxHeadingLevel:s,className:"table-of-contents",linkClassName:null}))}},3743:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(7462),a=n(7294),r=n(6668);function s(e){const t=e.map((e=>({...e,parentIndex:-1,children:[]}))),n=Array(7).fill(-1);t.forEach(((e,t)=>{const o=n.slice(2,e.level);e.parentIndex=Math.max(...o),n[e.level]=t}));const o=[];return t.forEach((e=>{const{parentIndex:n,...a}=e;n>=0?t[n].children.push(a):o.push(a)})),o}function l(e){let{toc:t,minHeadingLevel:n,maxHeadingLevel:o}=e;return t.flatMap((e=>{const t=l({toc:e.children,minHeadingLevel:n,maxHeadingLevel:o});return function(e){return e.level>=n&&e.level<=o}(e)?[{...e,children:t}]:t}))}function i(e){const t=e.getBoundingClientRect();return t.top===t.bottom?i(e.parentNode):t}function c(e,t){let{anchorTopOffset:n}=t;const o=e.find((e=>i(e).top>=n));if(o){return function(e){return e.top>0&&e.bottom<window.innerHeight/2}(i(o))?o:e[e.indexOf(o)-1]??null}return e[e.length-1]??null}function u(){const e=(0,a.useRef)(0),{navbar:{hideOnScroll:t}}=(0,r.L)();return(0,a.useEffect)((()=>{e.current=t?0:document.querySelector(".navbar").clientHeight}),[t]),e}function p(e){const t=(0,a.useRef)(void 0),n=u();(0,a.useEffect)((()=>{if(!e)return()=>{};const{linkClassName:o,linkActiveClassName:a,minHeadingLevel:r,maxHeadingLevel:s}=e;function l(){const e=function(e){return Array.from(document.getElementsByClassName(e))}(o),l=function(e){let{minHeadingLevel:t,maxHeadingLevel:n}=e;const o=[];for(let a=t;a<=n;a+=1)o.push(`h${a}.anchor`);return Array.from(document.querySelectorAll(o.join()))}({minHeadingLevel:r,maxHeadingLevel:s}),i=c(l,{anchorTopOffset:n.current}),u=e.find((e=>i&&i.id===function(e){return decodeURIComponent(e.href.substring(e.href.indexOf("#")+1))}(e)));e.forEach((e=>{!function(e,n){n?(t.current&&t.current!==e&&t.current.classList.remove(a),e.classList.add(a),t.current=e):e.classList.remove(a)}(e,e===u)}))}return document.addEventListener("scroll",l),document.addEventListener("resize",l),l(),()=>{document.removeEventListener("scroll",l),document.removeEventListener("resize",l)}}),[e,n])}function m(e){let{toc:t,className:n,linkClassName:o,isChild:r}=e;return t.length?a.createElement("ul",{className:r?void 0:n},t.map((e=>a.createElement("li",{key:e.id},a.createElement("a",{href:`#${e.id}`,className:o??void 0,dangerouslySetInnerHTML:{__html:e.value}}),a.createElement(m,{isChild:!0,toc:e.children,className:n,linkClassName:o}))))):null}const d=a.memo(m);function f(e){let{toc:t,className:n="table-of-contents table-of-contents__left-border",linkClassName:i="table-of-contents__link",linkActiveClassName:c,minHeadingLevel:u,maxHeadingLevel:m,...f}=e;const h=(0,r.L)(),v=u??h.tableOfContents.minHeadingLevel,k=m??h.tableOfContents.maxHeadingLevel,b=function(e){let{toc:t,minHeadingLevel:n,maxHeadingLevel:o}=e;return(0,a.useMemo)((()=>l({toc:s(t),minHeadingLevel:n,maxHeadingLevel:o})),[t,n,o])}({toc:t,minHeadingLevel:v,maxHeadingLevel:k});return p((0,a.useMemo)((()=>{if(i&&c)return{linkClassName:i,linkActiveClassName:c,minHeadingLevel:v,maxHeadingLevel:k}}),[i,c,v,k])),a.createElement(d,(0,o.Z)({toc:b,className:n,linkClassName:i},f))}},5162:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(7294),a=n(6010);const r="tabItem_Ymn6";function s(e){let{children:t,hidden:n,className:s}=e;return o.createElement("div",{role:"tabpanel",className:(0,a.Z)(r,s),hidden:n},t)}},5488:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(7462),a=n(7294),r=n(6010),s=n(2389),l=n(7392),i=n(7094),c=n(2466);const u="tabList__CuJ",p="tabItem_LNqP";function m(e){var t;const{lazy:n,block:s,defaultValue:m,values:d,groupId:f,className:h}=e,v=a.Children.map(e.children,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=d??v.map((e=>{let{props:{value:t,label:n,attributes:o}}=e;return{value:t,label:n,attributes:o}})),b=(0,l.l)(k,((e,t)=>e.value===t.value));if(b.length>0)throw new Error(`Docusaurus error: Duplicate values "${b.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const g=null===m?m:m??(null==(t=v.find((e=>e.props.default)))?void 0:t.props.value)??v[0].props.value;if(null!==g&&!k.some((e=>e.value===g)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${g}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:C,setTabGroupChoices:N}=(0,i.U)(),[y,E]=(0,a.useState)(g),S=[],{blockElementScrollPositionUntilNextRender:x}=(0,c.o5)();if(null!=f){const e=C[f];null!=e&&e!==y&&k.some((t=>t.value===e))&&E(e)}const I=e=>{const t=e.currentTarget,n=S.indexOf(t),o=k[n].value;o!==y&&(x(t),E(o),null!=f&&N(f,String(o)))},L=e=>{var t;let n=null;switch(e.key){case"Enter":I(e);break;case"ArrowRight":{const t=S.indexOf(e.currentTarget)+1;n=S[t]??S[0];break}case"ArrowLeft":{const t=S.indexOf(e.currentTarget)-1;n=S[t]??S[S.length-1];break}}null==(t=n)||t.focus()};return a.createElement("div",{className:(0,r.Z)("tabs-container",u)},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":s},h)},k.map((e=>{let{value:t,label:n,attributes:s}=e;return a.createElement("li",(0,o.Z)({role:"tab",tabIndex:y===t?0:-1,"aria-selected":y===t,key:t,ref:e=>S.push(e),onKeyDown:L,onClick:I},s,{className:(0,r.Z)("tabs__item",p,null==s?void 0:s.className,{"tabs__item--active":y===t})}),n??t)}))),n?(0,a.cloneElement)(v.filter((e=>e.props.value===y))[0],{className:"margin-top--md"}):a.createElement("div",{className:"margin-top--md"},v.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==y})))))}function d(e){const t=(0,s.Z)();return a.createElement(m,(0,o.Z)({key:String(t)},e))}},1895:(e,t,n)=>{n.d(t,{G:()=>a});n(7294);var o=n(2263);const a=()=>{const{siteConfig:e}=(0,o.Z)();return e.customFields.corsoVersion}},4638:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>p,default:()=>v,frontMatter:()=>u,metadata:()=>m,toc:()=>f});var o=n(7462),a=(n(7294),n(3905)),r=(n(8209),n(814)),s=n(5488),l=n(5162),i=n(3901),c=n(1895);const u={description:"Configure backup repository"},p="Repositories",m={unversionedId:"setup/repos",id:"setup/repos",title:"Repositories",description:"Configure backup repository",source:"@site/docs/setup/repos.md",sourceDirName:"setup",slug:"/setup/repos",permalink:"/docs/setup/repos",draft:!1,editUrl:"https://github.com/alcionai/corso/tree/main/docs/docs/setup/repos.md",tags:[],version:"current",frontMatter:{description:"Configure backup repository"}},d={},f=[{value:"Amazon S3",id:"amazon-s3",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Credential setup",id:"s3-creds-setup",level:3},{value:"Initialize repository",id:"initialize-repository",level:3},{value:"Connect to a repository",id:"connect-to-a-repository",level:3},{value:"S3-compatible object storage",id:"s3-compatible-object-storage",level:2}],h={toc:f};function v(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"repositories"},"Repositories"),(0,a.kt)("p",null,"A Corso ",(0,a.kt)("a",{parentName:"p",href:"concepts#corso-concepts"},"repository")," stores encrypted copies of your backup data. Repositories are\nsupported on the following object storage systems:"),(0,a.kt)(i.Z,{toc:f,maxHeadingLevel:2,mdxType:"TOCInline"}),(0,a.kt)("br",null),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Depending on community interest, Corso will add support for other object storage backends in the future.")),(0,a.kt)("h2",{id:"amazon-s3"},"Amazon S3"),(0,a.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"Before setting up your Corso S3 repository, the following prerequisites must be met:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The S3 bucket for the repository already exists. Corso won't create it for you."),(0,a.kt)("li",{parentName:"ul"},"You have access to credentials for a user or an IAM role that has the following permissions:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Action": [\n                "s3:PutObject",\n                "s3:GetObject",\n                "s3:ListBucket",\n                "s3:DeleteObject",\n                "s3:GetBucketLocation",\n            ],\n            "Resource": [\n                "arn:aws:s3:::<YOUR_BUCKET_NAME>",\n                "arn:aws:s3:::<YOUR_BUCKET_NAME>/*"\n            ]\n        }\n    ]\n}\n')),(0,a.kt)("h3",{id:"s3-creds-setup"},"Credential setup"),(0,a.kt)("p",null,"Corso supports the credential options offered by the AWS Go SDK. For Full details, see the ",(0,a.kt)("em",{parentName:"p"},"Specifying Credentials"),"\nsection of the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html"},"official documentation"),".\nThe two most commonly-used options are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Environment variables")," - set and export ",(0,a.kt)("inlineCode",{parentName:"p"},"AWS_ACCESS_KEY_ID")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"AWS_SECRET_ACCESS_KEY"),". If using temporary\ncredentials derived by assuming an IAM Role, you will also need ",(0,a.kt)("inlineCode",{parentName:"p"},"AWS_SESSION_TOKEN"),".")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Credentials file")," - ensure that the credentials file is available to Corso (for example, may need to map it if\nusing Corso as a container). You may also want to set and export ",(0,a.kt)("inlineCode",{parentName:"p"},"AWS_PROFILE"),", if not using the default profile, and\n",(0,a.kt)("inlineCode",{parentName:"p"},"AWS_SHARED_CREDENTIALS_FILE"),", if not using the default file location. You can learn more about the AWS CLI\nenvironment variables ",(0,a.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html"},"here"),"."))),(0,a.kt)("h3",{id:"initialize-repository"},"Initialize repository"),(0,a.kt)("p",null,"Before first use, you need to initialize a Corso repository with ",(0,a.kt)("inlineCode",{parentName:"p"},"corso repo init s3"),". See the command details\n",(0,a.kt)("a",{parentName:"p",href:"../cli/corso_repo_init_s3"},"here"),"."),(0,a.kt)(s.Z,{groupId:"os",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"win",label:"Powershell",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},'# Initialize the Corso Repository\n$Env:CORSO_PASSPHRASE = "CHANGE-ME-THIS-IS-INSECURE"\n.\\corso repo init s3 --bucket corso-test\n'))),(0,a.kt)(l.Z,{value:"unix",label:"Linux/macOS",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# Initialize the Corso Repository\nexport CORSO_PASSPHRASE="CHANGE-ME-THIS-IS-INSECURE"\n./corso repo init s3 --bucket corso-test\n'))),(0,a.kt)(l.Z,{value:"docker",label:"Docker",mdxType:"TabItem"},(0,a.kt)(r.Z,{language:"bash",mdxType:"CodeBlock"},`# Initialize the Corso Repository\nexport CORSO_PASSPHRASE="CHANGE-ME-THIS-IS-INSECURE"\ndocker run --env-file $HOME/.corso/corso.env \\\n  --volume $HOME/.corso:/app/corso ghcr.io/alcionai/corso:${(0,c.G)()} \\\n  repo init s3 --bucket corso-test`))),(0,a.kt)("h3",{id:"connect-to-a-repository"},"Connect to a repository"),(0,a.kt)("p",null,"If a repository already exists, you can connect to it with ",(0,a.kt)("inlineCode",{parentName:"p"},"corso repo connect s3"),". See the command details\n",(0,a.kt)("a",{parentName:"p",href:"../cli/corso_repo_connect_s3"},"here"),"."),(0,a.kt)(s.Z,{groupId:"os",mdxType:"Tabs"},(0,a.kt)(l.Z,{value:"win",label:"Powershell",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-powershell"},"# Connect to the Corso Repository\n.\\corso repo connect s3 --bucket corso-test\n"))),(0,a.kt)(l.Z,{value:"unix",label:"Linux/macOS",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"# Connect to the Corso Repository\n./corso repo connect s3 --bucket corso-test\n"))),(0,a.kt)(l.Z,{value:"docker",label:"Docker",mdxType:"TabItem"},(0,a.kt)(r.Z,{language:"bash",mdxType:"CodeBlock"},`# Connect to the Corso Repository\ndocker run --env-file $HOME/.corso/corso.env \\\n  --volume $HOME/.corso:/app/corso ghcr.io/alcionai/corso:${(0,c.G)()} \\\n  repo connect s3 --bucket corso-test`))),(0,a.kt)("h2",{id:"s3-compatible-object-storage"},"S3-compatible object storage"),(0,a.kt)("p",null,"Configuring Corso to use object storage systems compatible with the AWS S3 API (for example, Google Cloud Storage,\nBackblaze B2, MinIO, etc.) is almost identical to the Amazon S3 instructions above with the exception that you will\nneed to use the following flag with the initial Corso ",(0,a.kt)("inlineCode",{parentName:"p"},"repo init")," command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"  --endpoint <domain.example.com>\n")))}v.isMDXComponent=!0},8209:(e,t,n)=>{n(7294)}}]);